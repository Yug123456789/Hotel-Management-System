{% extends 'partials/base.html' %}
{% load static %}
{% block content %}

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hotel Details</title>
    <link rel="stylesheet" href="{% static 'css/hoteldetail.css' %}">
</head>

<div class="hotel-container">
    
    <!-- Hotel Image Section -->
    <div class="hotel-image">        
            <img src="{{ hotel.image.url }}" alt="{{ hotel.name }}">        
    </div>

    <!-- Hotel Details and Booking Section -->
    <div class="hotel-details-container">
        <!-- Hotel Info Section -->
        <div class="hotel-info">
            <h3>{{ hotel.name }}</h3>
            <p class="hotel-location">üìç {{ hotel.address }}</p>
            {% if user.is_authenticated %}
            <h3>Leave a Review</h3>
            {% if existing_review %}
                <p class="already-reviewed">‚úÖ You have already given your rating.</p>
            {% else %}
                <form method="post">
                    {% csrf_token %}
                    {{ form.as_p }}
                    <button type="submit">Submit Review</button>
                </form>
            {% endif %}
        {% else %}
            <p><a href="{% url 'userauthentication:sign-in' %}">Login</a> to leave a review.</p>
        {% endif %}

            <h3>Reviews</h3>
            {% for review in reviews %}
                <div class="review">
                    <strong>{{ review.user.username }}</strong> rated ‚≠ê {{ review.rating }}
                    <p>{{ review.review }}</p>
                    <small>{{ review.created_at }}</small>
                </div>
            {% empty %}
                <p>No reviews yet. Be the first!</p>
            {% endfor %}
        </div>
      
        
        <!-- Booking Section -->
        <form class="booking-section" method="POST" action="{% url 'booking:check_room_availability' %}">
            {% csrf_token %}
            <h3>üõé Check Available Rooms</h3>

            <input type="hidden" value="{{ hotel.id }}" name="hotel-id">

            <div class="form-group">
                <label for="checkin">Check-in Date</label>
                <input type="date" id="checkin" name="checkin" required>
            </div>

            <div class="form-group">
                <label for="checkout">Check-out Date</label>
                <input type="date" id="checkout" name="checkout" required>
            </div>

            <div class="form-group">
                <label for="room-type">Select Room Type</label>
                <select id="room-type" name="room_type">
                    {% for roomtype in hotel.hotel_room_types.all %}
                        <option value="{{ roomtype.slug }}">{{ roomtype.type }}</option>
                    {% endfor %}
                </select>
            </div>

            <button type="submit" class="btn check-availability">Check Availability</button>
            <br><br>
            <form method="post" action="{% url 'hotel:bookmark_hotel' hotel.id %}">
                {% csrf_token %}
                {% if user.is_authenticated %}
                    {% if hotel in user.bookmarked_hotels.all %}
                        <button type="submit" class="btn wishlist">‚ù§Ô∏è Remove Bookmark</button>
                    {% else %}
                        <button type="submit" class="btn wishlist">‚ô° Add to Favorites</button>
                    {% endif %}
                {% else %}
                    <a href="{% url 'userauthentication:sign-in' %}" class="btn wishlist">‚ô° Login to Bookmark</a>
                {% endif %}
            </form>
        </form>
    </div>

    <!-- Description Section -->
    <div class="hotel-description">
        <h3>Description</h3>
        <p>{{ hotel.description|safe }}</p>

        <div class="contact-info">
            <button>üìû {{ hotel.mobile }}</button>
            <button>üìß {{ hotel.email }}</button>
        </div>

        <!-- Available Room Types Table -->
        <div class="available-room-types">
            <h3>Available Room Types</h3>
            <table>
                <thead>
                    <tr>
                        <th>Room Type</th>
                        <th>Price</th>
                        <th>Available Rooms</th>
                        <th>Number of Beds</th>
                        <th>Room Capacity</th>
                    </tr>
                </thead>
                <tbody>
                    {% for roomtype in hotel.hotel_room_types.all %}
                        <tr>
                            <td>{{ roomtype.type }}</td>
                            <td>Rs {{ roomtype.price }}</td>
                            <td>{{ roomtype.rooms_count }}</td>
                            <td>{{ roomtype.number_of_beds }}</td>
                            <td>{{ roomtype.room_capacity }}</td>
                        </tr>
                    {% empty %}
                        <tr>
                            <td colspan="5">No room types available.</td>
                        </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>

   

        <!-- Amenities Section -->
        <div class="amenities-section">
            <h3>Featured Amenities On-Site</h3>
            <div class="amenity-card">
                <a href="{% url 'hotel:resturant' hotel.slug %}" class="restaurant-link">
                    <div class="amenity-icon">
                        <i class="fa fa-cutlery" aria-hidden="true"></i>
                    </div>
                    <div class="amenity-content">
                        <h4>Restaurant</h4>
                        <p>Explore our exquisite dining options</p>
                        <span class="view-more">View Details ‚Üí</span>
                    </div>
                </a>
            </div>
        </div>
    </div>
    
</div>

{% endblock content %}
